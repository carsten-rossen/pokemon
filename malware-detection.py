#!/usr/bin/python3

# Script Name: Signature-based Malware Detection Part 1 of 3
# Class Name: Ops 401
# Author Name: Carsten Rossen
# Date of Latest Revision: 5/17/21 
# Purpose: Search a directory for files with a specified name.


# Import functions

import os


# Main

# get name to search for
file_name = input("File name to search for: ")

# get name of directory to search in
dir_name = input("Directory to search in: ")
print()

# create a file with positives
os.system(f'find {dir_name} -name {file_name} > positives.txt')

# initiate positives counter
count = 0

# open file with positive hits
with open('positives.txt') as file:
    data = file.read()

    # print positive files to the screen and add to the positives counter
    for line in data.splitlines():
        print(line)
        count += 1

# print the number of files searched and the number of positives
print("\nFiles searched: "), os.system(f"ls {dir_name} | wc -l")
print(f"\nPositives detections: \n{count}")

# delete the file with positive hits
os.system('rm positives.txt')


# End